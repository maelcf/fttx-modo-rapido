<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Calculadora FTTX ‚Äì Pot√™ncia na Caixa</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- üîπ ADI√á√ÉO OBRIGAT√ìRIA PARA PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">

<style>
body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
  background: linear-gradient(135deg, #0f172a, #020617);
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
}

.card {
  width: 100%;
  max-width: 420px;
  background: #020617;
  border-radius: 20px;
  padding: 22px;
  box-shadow: 0 0 30px rgba(0,0,0,.6);
  border: 1px solid rgba(255,255,255,.08);
}

h1 {
  font-size: 20px;
  text-align: center;
  margin-bottom: 18px;
}

label {
  font-size: 13px;
  opacity: .85;
}

.input-group {
  margin-bottom: 14px;
}

input, select, button {
  width: 100%;
  padding: 12px;
  margin-top: 6px;
  border-radius: 12px;
  border: none;
  font-size: 15px;
}

input, select {
  background: #020617;
  color: #fff;
  border: 1px solid rgba(255,255,255,.15);
}

button {
  margin-top: 16px;
  background: #22c55e;
  color: #052e16;
  font-weight: bold;
  cursor: pointer;
}

button:hover {
  opacity: .9;
}

.toggle {
  display: flex;
  gap: 10px;
  margin-top: 8px;
}

.toggle button {
  flex: 1;
  background: #020617;
  color: #fff;
  border: 1px solid rgba(255,255,255,.2);
}

.toggle button.active {
  background: #2563eb;
}

.resultado {
  margin-top: 18px;
  padding: 16px;
  border-radius: 16px;
  background: #020617;
  border: 1px solid rgba(255,255,255,.15);
  text-align: center;
}

.resultado span {
  font-size: 22px;
  font-weight: bold;
}

.status {
  margin-top: 10px;
  padding: 10px;
  border-radius: 12px;
  font-weight: bold;
}

.bom {
  background: #16a34a;
  color: #052e16;
}

.alerta {
  background: #facc15;
  color: #422006;
}

.ruim {
  background: #dc2626;
  color: #450a0a;
}
</style>
</head>

<body>

<div class="card">
  <h1>üì° Pot√™ncia FTTX ‚Äì Caixa</h1>

  <div class="input-group">
    <label>Pot√™ncia que chega na fibra (dBm ‚Äì inteiro)</label>
    <input type="number" id="entrada" placeholder="Ex: 18">
    <div class="toggle">
      <button id="btnNeg" onclick="setSign(-1)">‚àí Negativo</button>
      <button id="btnPos" class="active" onclick="setSign(1)">+ Positivo</button>
    </div>
  </div>

  <div class="input-group">
    <label>Splitter desbalanceado</label>
    <select id="desbalanceado">
      <option value="0.01">1 / 99</option>
      <option value="0.02">2 / 98</option>
      <option value="0.05">5 / 95</option>
      <option value="0.10">10 / 90</option>
      <option value="0.15">15 / 85</option>
      <option value="0.20">20 / 80</option>
      <option value="0.25">25 / 75</option>
      <option value="0.30">30 / 70</option>
      <option value="0.35">35 / 65</option>
      <option value="0.40">40 / 60</option>
      <option value="0.45">45 / 55</option>
    </select>
  </div>

  <div class="input-group">
    <label>Splitter na caixa</label>
    <select id="splitCaixa">
      <option value="3.5">1:2 ‚Äì 3.5 dB</option>
      <option value="7.2">1:4 ‚Äì 7.2 dB</option>
      <option value="10.5">1:8 ‚Äì 10.5 dB</option>
      <option value="13.8">1:16 ‚Äì 13.8 dB</option>
      <option value="17.0">1:32 ‚Äì 17.0 dB</option>
      <option value="20.5">1:64 ‚Äì 20.5 dB</option>
    </select>
  </div>

  <button onclick="calcular()">Calcular</button>

  <div class="resultado" id="resultado">
    <div>Pot√™ncia final na caixa</div>
    <span>‚Äî dBm</span>
  </div>
</div>

<script>
let sign = 1;

function setSign(valor) {
  sign = valor;
  document.getElementById("btnNeg").classList.remove("active");
  document.getElementById("btnPos").classList.remove("active");
  if (valor === -1) document.getElementById("btnNeg").classList.add("active");
  else document.getElementById("btnPos").classList.add("active");
}

function calcular() {
  const valor = parseInt(document.getElementById("entrada").value);
  if (isNaN(valor)) {
    alert("Informe a pot√™ncia.");
    return;
  }

  const entrada = valor * sign;
  const percentual = parseFloat(document.getElementById("desbalanceado").value);
  const perdaCaixa = parseFloat(document.getElementById("splitCaixa").value);

  const perdaDesbalanceado = -10 * Math.log10(percentual);
  const potenciaFinal = entrada - perdaDesbalanceado - perdaCaixa;

  let status = "";
  let classe = "";

  if (potenciaFinal <= -8 && potenciaFinal > -20) {
    status = "üü¢ BOM";
    classe = "bom";
  } 
  else if (potenciaFinal <= -20 && potenciaFinal > -23) {
    status = "üü° ALERTA";
    classe = "alerta";
  }
  else if (potenciaFinal <= -23 && potenciaFinal >= -28) {
    status = "üü† CR√çTICO";
    classe = "alerta";
  }
  else {
    status = "üî¥ FORA DO PADR√ÉO";
    classe = "ruim";
  }

  document.getElementById("resultado").innerHTML = `
    <div>Pot√™ncia final na caixa</div>
    <span>${potenciaFinal.toFixed(2)} dBm</span>
    <div class="status ${classe}">${status}</div>
  `;
}
</script>

<!-- üîπ REGISTRO DO SERVICE WORKER (PWA) -->
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>

